# Советы по работе с зависимостями

## Обновление зависимостей

Для проверки актульности зависимостей проекта пакетный менеджер npm имеет встроенную команду `npm outdated`. Её вывод может быть примерно таким:

```sh
Package             Current   Wanted   Latest  Location
autoprefixer         10.2.6   10.3.1   10.3.1  global
esbuild              0.12.9  0.12.15  0.12.15  global
eslint               7.29.0   7.31.0   7.31.0  global
gulp-esbuild          0.8.2    0.8.3    0.8.3  global
lint-staged          11.0.0   11.0.1   11.0.1  global
markdown-it          12.0.6   12.1.0   12.1.0  global
markdown-it-anchor    8.0.3    8.1.0    8.1.0  global
simple-git-hooks      2.4.1    2.5.1    2.5.1  global
```

Из таблицы видно, что некоторые зависимости имеют обновлённые минорые или патч-версии. В таком случае безопасно (с точки зрения семантического версионирования) выполнить команду `npm update` или `npm update <package-name>`.

Некоторые зависимости имеют обновлённую мажорную версию. Перед её установкой полезно узнать, какие изменения произошли в пакете. Это могут быть кардинальные изменения внешнего API или ядра библиотеки. Обычно изменения хранятся в файлах _CHANGELOG_, _CHANGELOG.md_ или _NEWS_ в корне репозитория проекта. Перейти к репозиторию можно командой `npm repo <package-name>`.

В случае, если нас всё устраивает, можно обновить мажорную версию пакета: `npm i <package-name>@latest`. После обновления нужно обязательно проверить корректность выполнения команды `npm run build` и её результатов.

Есть способ массово обновить все зависимости до новых мажорных версий с помощью стороннего пакета `npm-check-updates`:

```
npx npm-check-updates -u
npm install
```

## Разрешение конфликтов в файле _package-lock.json_

Иногда могут возникнуть конфликты слияния в Git для _package-lock.json_. Править руками этот файл можно лишь в исключительных ситуациях.

Для разрешения конфликтов в этом файле можно использовать следующий алгоритм:

- правим конфликты (если есть) в файле _package.json_;
- принимаем изменения в _package-lock.json_ из той ветки, которую вливаем в свою;
- обновляем файл _package-lock.json_, выполнив команду `npm install`.
